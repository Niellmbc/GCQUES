<!DOCTYPE html>
<html lang="en">

<head>
	<title>Logs</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<link href="assets/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Prompt" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
	<link href="assets/css/mdb.min.css" rel="stylesheet">
	<link href="assets/css/font-awesome.css" rel="stylesheet">
	<link href="assets/css/stepper.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="assets/css/style.css">
	<link rel="stylesheet" type="text/css" href="assets/css/animate.css">
	<link rel="stylesheet" type="text/css" href="assets/css/sweetalert-master/dist/sweetalert.css">
	<!-- <link rel="stylesheet" type="text/css" href="assets/css/sweetalert-master/dist/sweetalert.min.css"> -->
</head>

<body class="fixed-sn">

	<!--Main Navigation-->
	<header>

		<!-- Sidebar navigation -->
		<div id="slide-out" class="side-nav fixed sidenavb">
			<ul class="custom-scrollbar">
				<li class="logo-sn d-block waves-effect">
					<div class="text-center">
						<a class="pl-0 text-white" href="#">Super Admin Account</a>
					</div>
				</li>	
				<!-- Card -->

				<div class="card card-image" style="background-image: url(assets/img/gcueslogo.png);">

					<!-- Content -->
					<div class="text-white flex-center d-flex align-items-center rgba-black-strong py-5 px-4">
						<div>
							<div class="col-xl-5 col-md-4 mb-3 text-center float-left">

								<img src="" id="profPic" class="img-fluid z-depth-1 rounded-circle"
								alt="Responsive image">

							</div>
							<div class="float-right">
								<p id="pName" style="font-size: 14px;"></p>
								<p id="pEmail" style="font-size: 14px;"></p>
							</div>
						</div>
					</div>
					<!-- Content -->
				</div>
				<!-- Card -->
				<!-- Side navigation links -->
				<li>
					<ul class="collapsible collapsible-accordion">
						<li><a class="collapsible-header waves-effect arrow-r " href="admin.html"><i class="fa fa-tachometer"></i> Dashboards</a>
						</li>
						<li>
							<a class="collapsible-header waves-effect arrow-r" href="AddUser.html"><i class="fa fa-user"></i>Users</a>
						</li>
						<li>
							<a class="collapsible-header waves-effect arrow-r" href="adminTransactions.html"><i class="fa fa-folder"></i>Transactions</a>
						</li>
						<li>
							<a class="collapsible-header waves-effect arrow-r" href="adminAccount.html"><i class="fa fa-cog"></i>Account Settings</a>
						</li>
						<li>
							<a class="collapsible-header waves-effect arrow-r active" href="allLogs.html"><i class="fa fa-book"></i>Activity Logs</a>
						</li>
						

					</ul>
				</li>
				<!--/. Side navigation links -->
			</ul>
			<div class="sidenav-bg mask-strong"></div>
		</div>
		<!--/. Sidebar navigation -->

		<!-- Navbar -->
		<nav class="navbar fixed-top navbar-expand-lg scrolling-navbar double-nav navb">
			<!-- SideNav slide-out button -->
			<div class="float-left">
				<a href="#" data-activates="slide-out" class="button-collapse black-text"><i class="fa fa-bars text-white"></i></a>
			</div>
			<!-- Breadcrumb-->
			<div class="breadcrumb-dn">
				<p>Gordon College Cashier Queueing</p>
			</div>
			<!--Navbar links-->
			<ul class="nav navbar-nav nav-flex-icons ml-auto">

				
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle waves-effect" href="#" id="userDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<i class="fa fa-user "></i> <span class="clearfix d-none d-sm-inline-block ">Profile</span></a>
					</a>
					<div class="dropdown-menu dropdown-menu-right dropdown-default" aria-labelledby="userDropdown">
						<a class="dropdown-item" onclick="logOutAdmin()">Log Out</a>
						<a class="dropdown-item" href="adminAccount.html">My account</a>
					</div>
				</li>

			</ul>
			<!--/Navbar links-->
		</nav>
		<!-- /.Navbar -->

	</header>
	<!--Main Navigation-->

	<!--Main layout-->
	<main>
		<div class="container-fluid">
			<h3 id="todaydate" class="grey-text text-center"></h3>
			<table id="dtBasicExample" class="table table-striped table-bordered" cellspacing="0" width="100%">
				<thead>
					<tr>
						<th class="th-sm">Student No
						</th>
						<th class="th-sm">Cashier No
						</th>
						<th class="th-sm">Queue No
						</th>
						<th class="th-sm">Office Transaction
						</th>
						<th class="th-sm">Transaction Type
						</th>
						<th class="th-sm">Date
						</th>
						<th class="th-sm">Remarks
						</th>
					</tr>
				</thead>
				<tbody id="logs">

				</tbody>
			</table>
			<center>
				<button class="btn btn-outline-primary "><a href="printlogtoday.html"><i class="fa fa-print"></i> Print Report</button>
				</center>
			</div>
		</main>
		<!-- /Main Layout -->

	</body>

	<script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
	<script src="https://js.pusher.com/4.3/pusher.min.js"></script>
	<script type="text/javascript" src="js/popper.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/mdb.min.js"></script>
	<script type="text/javascript" src="js/Chart.min.js"></script>
	<script type="text/javascript" src="js/Chart.bundle.min.js"></script>
	<script type="text/javascript" src="js/cashier.js"></script>
	<!-- <script type="text/javascript" src="js/receiver.js"></script> -->
	<script type="text/javascript" src="js/wow.min.js"></script>
	<script type="text/javascript" src="js/sweetalert-master/dist/sweetalert.min.js"></script>

	<script>
        // SideNav Initialization
        $(".button-collapse").sideNav();
        $('.datepicker').pickadate({format : "yyyy-mm-d"});
        var container = document.querySelector('.custom-scrollbar');
        Ps.initialize(container, {
        	wheelSpeed: 2,
        	wheelPropagation: true,
        	minScrollbarLength: 20
        });
        
    </script>
    <script>
    	var month = ['January','February','March','April','May','June','July','August','September','October','November','December'];
    	var today = new Date();
    	var dd = today.getDate();
    	var dd1 = today.getDate();
	var mm = today.getMonth()+1; //January is 0!
	if(mm <10){
		mm= "0"+mm;
	}
	var monthName = month[today.getMonth()];
	var yyyy = today.getFullYear();
	var date = monthName+" "+dd1+", "+yyyy;
	document.getElementById('todaydate').innerHTML=date;
	let datetoday = yyyy+"-"+mm+"-"+dd1;
	let logs=()=>{
		fetch(url+'/tbl_log/fldDay/'+datetoday).then(res=>res.json()).then(function(res){
			console.log(res);
			let ls ="";
			for(let i=0;i<res.length;i++){
				ls+='<tr>';
				ls+='<td>'+res[i].fldStudentNo+'</td>';
				ls+='<td>'+res[i].fldCashierNo+'</td>';
				ls+='<td>'+res[i].fldQueueNo+'</td>';
				ls+='<td>'+res[i].fldOffice+'</td>';
				ls+='<td>'+res[i].fldTransType+'</td>';
				ls+='<td>'+res[i].fldDate+'</td>';
				if(res[i].fldRemarks=='Done'){
					ls+='<td><span class="badge badge-success">'+res[i].fldRemarks+'</span></td>';
				}else{
					ls+='<td><span class="badge badge-danger">'+res[i].fldRemarks+'</span></td>';
				}

				ls+='</tr>';
			}
			$('#logs').html(ls);
		});
	}
	logs();
</script>
<script>
	let id= localStorage.adminID;
	fetch(url+'/tbl_user/fldUserID/'+id).then(res=>res.json()).then(function(res){
		document.getElementById('pName').innerHTML=res[0].fldFname+' '+res[0].fldMname+' '+res[0].fldLname;
		document.getElementById('pEmail').innerHTML=res[0].fldEmail;
		document.getElementById('profPic').src=res[0].fldImg;
	});

    	// let range =()=>{
    	// 	let startingDate = document.getElementById('startingDate').value;
    	// 	let endingDate = document.getElementById('endingDate').value;
    	// 	console.log(startingDate+'<br>'+endingDate);
    	// 	fetch(url+'/range/tbl_log/fldDay/'+startingDate+'/'+endingDate).then(res=>res.json()).then(function(res){
    	// 		let ls ="";
    	// 		for(let i=0;i<res.length;i++){
    	// 			ls+='<tr>';
    	// 			ls+='<td>'+res[i].fldStudentNo+'</td>';
    	// 			ls+='<td>'+res[i].fldCashierNo+'</td>';
    	// 			ls+='<td>'+res[i].fldQueueNo+'</td>';
    	// 			ls+='<td>'+res[i].fldOffice+'</td>';
    	// 			ls+='<td>'+res[i].fldTransType+'</td>';
    	// 			ls+='<td>'+res[i].fldDate+'</td>';
    	// 			if(res[i].fldRemarks=='Done'){
    	// 				ls+='<td><span class="badge badge-success">'+res[i].fldRemarks+'</span></td>';
    	// 			}else{
    	// 				ls+='<td><span class="badge badge-danger">'+res[i].fldRemarks+'</span></td>';
    	// 			}

    	// 			ls+='</tr>';
    	// 		}
    	// 		$('#logs').html(ls);
    	// 	});
    	// }
    	Pusher.logToConsole = true;

    	var pusher = new Pusher('5fb69c9d534cd55d78e7', {
    		cluster: 'ap1',
    		forceTLS: true
    	});

    	var channel = pusher.subscribe('my-channel');
    	channel.bind('my-event', function(data) {
    		logs();
    	});
    </script>
    </html>